<?xml version="1.0" encoding="UTF-8"?>
<!--
    mixer_paths.xml — ALSA mixer paths for AudioShift 432Hz Custom ROM
    Device  : Samsung Galaxy S25+ (SM-S936B)
    Codec   : Qualcomm WCD938x on Snapdragon 8 Elite (SM8750)
    Path    : path_b_rom/device_configs/ (copied by build_rom.sh §Step 3)

    Controls follow the ALSA kcontrol / UCM naming for WCD938x + LPASS.
    The AudioShift DSP tap-point is inserted immediately before the
    Digital Output switch so pitch shift is applied before D/A conversion.
-->

<mixer>

    <!-- ===================================================================
         Device power defaults (startup state)
         =================================================================== -->
    <path name="speaker-gain-default">
        <ctl name="RX_CDC_DMA_RX_0 Audio Mixer MultiMedia1" value="1"/>
        <ctl name="RX_CDC_DMA_RX_0 Audio Mixer MultiMedia2" value="1"/>
    </path>

    <!-- ===================================================================
         AudioShift 432Hz DSP Insert Point
         Applied before analog conversion on every music-class path.
         The kcontrol "AudioShift Enable" is registered by the custom
         platform driver loaded from path_b_rom/kernel/audioshift_dsp.patch.
         =================================================================== -->
    <path name="audioshift-enable">
        <ctl name="AudioShift Enable"               value="1"/>
        <ctl name="AudioShift Pitch Cents"          value="-52"/>   <!-- -0.5296 semitones -->
        <ctl name="AudioShift Sample Rate"          value="48000"/>
        <ctl name="AudioShift Buffer Frames"        value="8192"/>
        <ctl name="AudioShift Engine"               value="WSOLA"/>
    </path>

    <path name="audioshift-disable">
        <ctl name="AudioShift Enable"               value="0"/>
    </path>

    <!-- ===================================================================
         Speaker
         =================================================================== -->
    <path name="speaker">
        <path name="audioshift-enable"/>
        <ctl name="WSA_CDC_DMA_RX_0 Audio Mixer MultiMedia1"    value="1"/>
        <ctl name="WSA_CDC_DMA_RX_0 Audio Mixer MultiMedia2"    value="1"/>
        <ctl name="WSA_CDC_DMA_RX_0 Audio Mixer MultiMedia7"    value="1"/>
        <ctl name="WSA RX_0 MUX"                                value="AIF1_PB"/>
        <ctl name="SpkrLeft WSA PA Enable"                      value="1"/>
        <ctl name="SpkrRight WSA PA Enable"                     value="1"/>
        <ctl name="WSA_SPKR_PA_Enable"                          value="1"/>
    </path>

    <path name="speaker-safe">
        <path name="speaker"/>
    </path>

    <!-- ===================================================================
         Headphones (3.5 mm / Type-C analog)
         =================================================================== -->
    <path name="headphones">
        <path name="audioshift-enable"/>
        <ctl name="RX_CDC_DMA_RX_0 Audio Mixer MultiMedia1"     value="1"/>
        <ctl name="RX_CDC_DMA_RX_0 Audio Mixer MultiMedia2"     value="1"/>
        <ctl name="RX_CDC_DMA_RX_0 Audio Mixer MultiMedia7"     value="1"/>
        <ctl name="RX INT0_1 MIX1 INP0"                         value="RX0"/>
        <ctl name="RX INT1_1 MIX1 INP0"                         value="RX1"/>
        <ctl name="HPHL_COMP Switch"                            value="1"/>
        <ctl name="HPHR_COMP Switch"                            value="1"/>
        <ctl name="HPHL Switch"                                 value="1"/>
        <ctl name="HPHR Switch"                                 value="1"/>
        <ctl name="WCD_HPHL_COMP Switch"                        value="1"/>
        <ctl name="WCD_HPHR_COMP Switch"                        value="1"/>
    </path>

    <!-- ===================================================================
         Wired headset (with microphone)
         =================================================================== -->
    <path name="headset">
        <path name="headphones"/>
    </path>

    <!-- ===================================================================
         Earpiece (voice call)
         Note: AudioShift intentionally NOT applied to voice earpiece
         to avoid adding latency / perceived reverb during calls.
         =================================================================== -->
    <path name="earpiece">
        <ctl name="RX_CDC_DMA_RX_0 Audio Mixer MultiMedia1"    value="1"/>
        <ctl name="RX INT0_1 MIX1 INP0"                        value="RX0"/>
        <ctl name="HPHL Switch"                                 value="1"/>
        <ctl name="EAR PA Gain"                                 value="G_6_DB"/>
        <ctl name="EAR_S Switch"                                value="1"/>
    </path>

    <!-- ===================================================================
         Bluetooth SCO (HFP voice)
         AudioShift NOT applied (processed at Bluetooth stack level)
         =================================================================== -->
    <path name="bt-sco">
        <ctl name="SLIM_7_RX Audio Mixer MultiMedia1"           value="1"/>
        <ctl name="BT_RX VolumeStepLeft"                        value="7"/>
        <ctl name="BT_RX VolumeStepRight"                       value="7"/>
    </path>

    <path name="bt-sco-wb">
        <path name="bt-sco"/>
        <ctl name="SLIM_7_RX Sample Rate"                       value="16000"/>
    </path>

    <!-- ===================================================================
         Bluetooth A2DP (music, high quality)
         AudioShift applied via AudioFlinger effect chain before A2DP
         encoding — no mixer kcontrol needed (software-only path)
         =================================================================== -->
    <path name="bt-a2dp">
        <path name="audioshift-enable"/>
        <ctl name="SLIM_7_RX Audio Mixer MultiMedia1"           value="1"/>
        <ctl name="SLIM_7_RX Audio Mixer MultiMedia2"           value="1"/>
    </path>

    <!-- ===================================================================
         USB audio — headset
         =================================================================== -->
    <path name="usb-headphones">
        <path name="audioshift-enable"/>
        <ctl name="USB_AUDIO_RX Audio Mixer MultiMedia1"        value="1"/>
        <ctl name="USB_AUDIO_RX Audio Mixer MultiMedia2"        value="1"/>
        <ctl name="USB_AUDIO_RX Audio Mixer MultiMedia7"        value="1"/>
    </path>

    <path name="usb-headset">
        <path name="usb-headphones"/>
    </path>

    <!-- ===================================================================
         Microphone — Built-in main (bottom)
         =================================================================== -->
    <path name="mic1">
        <ctl name="TX_CDC_DMA_TX_3 Audio Mixer MultiMedia1"    value="1"/>
        <ctl name="TX SMIC MUX0"                               value="SWR_MIC9"/>
        <ctl name="ADC1_MIXER Switch"                          value="1"/>
        <ctl name="ADC1 Volume"                                value="60"/>
        <ctl name="DEC0 MUX"                                   value="SWR_MIC"/>
    </path>

    <!-- ===================================================================
         Microphone — Built-in secondary (top / noise-cancel)
         =================================================================== -->
    <path name="mic2">
        <ctl name="TX_CDC_DMA_TX_3 Audio Mixer MultiMedia1"    value="1"/>
        <ctl name="TX SMIC MUX1"                               value="SWR_MIC10"/>
        <ctl name="ADC2_MIXER Switch"                          value="1"/>
        <ctl name="ADC2 Volume"                                value="60"/>
        <ctl name="DEC1 MUX"                                   value="SWR_MIC"/>
    </path>

    <!-- ===================================================================
         Microphone — Headset (CTIA 3-pole)
         =================================================================== -->
    <path name="headset-mic">
        <ctl name="TX_CDC_DMA_TX_3 Audio Mixer MultiMedia1"    value="1"/>
        <ctl name="TX DMIC MUX0"                               value="DMIC1"/>
        <ctl name="ADC3_MIXER Switch"                          value="1"/>
        <ctl name="ADC3 Volume"                                value="60"/>
    </path>

    <!-- ===================================================================
         Voice call paths
         =================================================================== -->
    <path name="incall-rec-uplink">
        <ctl name="INCALL_RECORD_TX Audio Mixer MultiMedia1"   value="1"/>
    </path>

    <path name="incall-rec-downlink">
        <ctl name="INCALL_RECORD_RX Audio Mixer MultiMedia1"   value="1"/>
    </path>

    <!-- ===================================================================
         Loopback / screen-cast capture (RemoteSubmix)
         =================================================================== -->
    <path name="record-loopback">
        <ctl name="INCALL_MUSIC_UPLINK Audio Mixer MultiMedia1" value="1"/>
    </path>

    <!-- ===================================================================
         Deep buffer low-power path (music, screen off)
         AudioShift DSP remains active to maintain continuous 432Hz output.
         =================================================================== -->
    <path name="deep-buffer-playback">
        <path name="audioshift-enable"/>
        <ctl name="RX_CDC_DMA_RX_0 Audio Mixer MultiMedia1"    value="1"/>
    </path>

    <!-- ===================================================================
         Low latency (fast) path — gaming / notification sounds
         AudioShift NOT applied to preserve minimal latency.
         =================================================================== -->
    <path name="low-latency-playback">
        <ctl name="RX_CDC_DMA_RX_0 Audio Mixer MultiMedia5"    value="1"/>
    </path>

    <!-- ===================================================================
         AudioShift diagnostic path (enable while ADB-connected for tuning)
         =================================================================== -->
    <path name="audioshift-loopback-test">
        <path name="audioshift-enable"/>
        <ctl name="LOOPBACK Audio Mixer MultiMedia1"            value="1"/>
        <ctl name="AudioShift Enable"                           value="1"/>
        <ctl name="AudioShift Debug Mode"                       value="1"/>
    </path>

</mixer>
