# AudioShift — Novel Concepts & Patent Ideas

> **Disclaimer:** This document captures potentially novel technical concepts for research and
> business evaluation purposes only. It is not legal advice. Prior art searches and formal patent
> prosecution require qualified patent counsel. All references to existing products (Magisk, Android,
> SoundTouch) are descriptive of the technical landscape.

---

## Concept 1 — Transparent System-Level Frequency Domain Tuning via OS Audio Effects API

### Summary

A method for globally shifting the playback frequency of all audio content on an Android device
through the standard Audio Effects plugin interface, achieving perceptually seamless 432 Hz tuning
without any application-layer changes.

### Novel Aspects

**1a. Frequency-ratio pitch shifting as OS-level audio post-processing**

Prior art: Application-level pitch shift (e.g., power-user audio players with built-in pitch
controls). Distinctively: our approach operates below the application layer, affecting *all* audio
sources uniformly, including streaming apps that have no pitch control, background audio, and system
UI sounds.

**1b. Deployment via system extension mechanism (Magisk overlay) without partition modification**

Using the Android Verified Boot overlay mechanism (as implemented by Magisk) to inject an audio
effect plugin into the vendor soundfx directory — achieving system-wide effect registration without
permanently altering signed system partitions. Device returns to un-modified state upon module
removal.

**1c. Pitch constant derived from 432/440 Hz ratio applied in WSOLA time-domain stretching**

The specific application of the ratio `432/440 = 0.981818...` (approximately -0.3164 semitones)
as a pitch-shift parameter in the WSOLA algorithm, with tolerance verification against spectral
analysis, constitutes a specific reduction to practice of the 432 Hz tuning concept in digital audio.

---

## Concept 2 — Dual-Path System Audio Modification with Shared DSP Core

### Summary

A framework architecture for developing audio processing modifications for Android that maintains
a single shared DSP implementation usable via two independent delivery paths: (1) direct integration
into the AudioFlinger mixer (PATH-B / custom ROM), and (2) the Android Audio Effects API plugin
mechanism (PATH-C / Magisk), enabling the same perceptual audio modification to be deployed across
user contexts ranging from stock-rooted devices to fully custom ROM installations.

### Novel Aspects

**2a. Common DSP abstraction layer below both OS-level integration points**

The pattern of a shared `Audio432HzConverter` C++ class (via Pimpl idiom) with a uniform interface
(`process()`, `setSampleRate()`, `getLatencyMs()`) that is linked into both an AudioFlinger patch
and an Android Effect plugin is novel. It allows algorithm improvements in one location to propagate
to both deployment targets simultaneously.

**2b. Verification toolchain spanning host and device**

A test and measurement pipeline that: (a) generates test tones on a host computer via `sox`; (b)
transfers and plays them through the modified Android audio stack via ADB; (c) captures the output;
(d) performs multi-method FFT analysis (windowed FFT peak + autocorrelation + librosa pyin) using
median consensus to verify the frequency shift to within ±0.5 Hz accuracy; and (e) produces a
PASS/FAIL verdict with JSON-serializable metrics — spanning host-device boundary without on-device
Python runtime.

---

## Concept 3 — Sub-Bin Frequency Measurement via Quadratic Interpolation for Audio Effect Verification

### Summary

A method for verifying audio processing accuracy to sub-Hz precision using quadratic interpolation
of FFT magnitude bins in the neighborhood of a detected spectral peak, combined with multi-method
consensus scoring (FFT peak, autocorrelation HPS, pyin F0 estimation), used to characterize the
frequency accuracy of real-time pitch-shift audio effects running on consumer hardware.

### Technical Novelty

Standard FFT bin resolution at 48 kHz sample rate, 8192-point FFT:
```
Δf = sample_rate / N = 48000 / 8192 ≈ 5.86 Hz per bin
```

The 432 / 440 Hz shift is only 8 Hz. Naive FFT peak detection would classify 432 Hz and 440 Hz
in the same bin with high probability, making verification impossible.

**Quadratic interpolation** between the peak bin and its neighbors:
```python
d = 0.5 * (mag[k-1] - mag[k+1]) / (mag[k-1] - 2*mag[k] + mag[k+1])
peak_hz = (k + d) * sample_rate / N
```
reduces effective frequency uncertainty to `Δf / 8 ≈ 0.73 Hz` — sufficient to distinguish 432 Hz
from 440 Hz with high confidence.

**The combination of:** quadratic-interpolated FFT + ACF harmonic product spectrum + pyin voiced
fraction + median consensus, applied specifically to the problem of verifying a small-interval
(≈0.32 semitone) pitch shift on a captured hardware audio loopback, is a specific and potentially
novel measurement methodology for audio effect QA.

---

## Concept 4 — Property-Based Effect Enable/Disable Without Audio Restart

### Summary

Using Android system property hot-reload (`resetprop` in Magisk, or `setprop` in custom ROMs) to
dynamically control an audio effect's enabled state through the `effectCommand(EFFECT_CMD_ENABLE)`/
`EFFECT_CMD_DISABLE` path, driven by a system property watcher thread running inside the `.so`,
enabling real-time toggling of the pitch-shift effect without stopping or restarting audio playback.

### Technical Novelty

This combines:
1. A background thread in the audio effect shared library monitoring `__system_property_get("persist.audioshift.enabled")`
2. Atomic flag (`std::atomic<bool>`) checked on every `effectProcess()` call for zero-lock hot path
3. Clean bypass: when disabled, `effectProcess()` memcpys input → output without SoundTouch
   processing in `O(1)` (branch prediction-friendly path)

The result is a system property-controlled audio effect toggle with sub-10ms latency (one audio
period), enabling users or automation scripts to A/B compare 440 Hz vs. 432 Hz in real time.

---

## Concept 5 — Latency-Bounded WSOLA Configuration for Real-Time System Effects

### Summary

A method for configuring SoundTouch WSOLA parameters to achieve a target maximum-latency bound when
used as a system-level audio postprocess effect, where the latency budget is constrained by the
sum of WSOLA sequence length and hardware period size, and optimized towards a specific target
(e.g., 20 ms total) via joint parameter selection.

### Parameter Space

```
Variables:
  T_seq  = SETTING_SEQUENCE_MS (controls WSOLA segment size)
  T_seek = SETTING_SEEKWINDOW_MS (controls transition window)
  P_hw   = hardware period (device-fixed, typically 5–10 ms)

Constraint:
  T_seq + T_seek + P_hw ≤ 20 ms

Current solution:
  T_seq=20ms, T_seek=10ms, P_hw≈5ms → 20ms ≤ 20ms (just fits)
  Quality trade-off: QUICKSEEK=1 compensates for smaller sequence window
```

The formulation of WSOLA configuration as a constrained optimization problem with a latency budget
bound, applied to the domain of system-level Android audio postprocessing effects, is novel in its
specific application context.

---

## Concept 6 — Multi-Strategy Pitch Verification with Confidence Weighting

### Summary

A measurement methodology that applies three independent pitch estimation algorithms (FFT spectral
peak, autocorrelation fundamental, pyin probabilistic F0), weights each by its applicability and
confidence score (voiced probability for pyin, magnitude SNR for FFT), and computes a weighted or
median consensus pitch estimate, applied to the problem of verifying pitch-shift accuracy in
real-time audio processing hardware.

### Value Proposition

Single-method pitch detection fails frequently on:
- Low-SNR captures (hardware loopback noise)
- Signals with strong harmonics (FFT peak may land on 2nd harmonic)
- Short capture windows (insufficient pyin voiced frames)

Multi-method consensus with fallback reduces the false-PASS rate (declaring a wrong pitch as correct)
and false-FAIL rate (declaring a correct pitch as wrong) in automated audio effect verification.

---

## Prior Art Landscape

| Domain | Relevant Prior Art | Our Differentiation |
|--------|-------------------|---------------------|
| 432 Hz tuning | Zephyr 432 EVO player, music theory literature | OS-level, not player-level |
| Audio effects plugins | iOS AUv3, VST plugins, Android Equalizer | Standard API, novel purpose |
| Magisk modules | Many existing audio modules (ViPER4Android, Dolby) | 432 Hz pitch ratio specifically |
| Pitch shifters | SoundTouch library, RubberBand | Integration pattern, not algorithm |
| FFT verification | Lab measurement tools (ARTA, REW) | Automated ADB pipeline |
| Dual-path arch | Not found in audio engineering literature | Novel framework pattern |

---

## Recommended Next Steps (For Patent Evaluation)

1. **Prior art search**: Verify claims 1a, 1b, 3, 6 against Google Patents, USPTO, EPO
2. **Novelty assessment**: Engage patent counsel for freedom-to-operate on Android Effects API use
3. **Reduction to practice**: The working code in this repository constitutes reduction to practice
   for concepts 1–5
4. **Provisional filing**: Consider provisional application for concept 2 (dual-path shared DSP architecture)
   and concept 3 (sub-bin measurement methodology) — lowest prior art risk

---

## Technical IP Summary

The most defensible novel contributions of AudioShift Phase 3 are:

| Rank | Concept | Novelty Score | Utility Score |
|------|---------|---------------|---------------|
| 1 | Dual-path shared DSP core (Concept 2) | High | High |
| 2 | Sub-bin FFT verification pipeline (Concept 3) | High | High |
| 3 | Latency-bounded WSOLA configuration (Concept 5) | Medium | Medium |
| 4 | Property-driven real-time toggle (Concept 4) | Medium | High |
| 5 | System-level 432 Hz OS effect (Concept 1) | Low–Medium | High |
| 6 | Multi-strategy consensus verification (Concept 6) | Medium | Medium |
